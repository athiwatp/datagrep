<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/utils/linearAlgebra.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  <a href="test.html" data-ice="testLink">Test</a>
  <a data-ice="repoURL" href="https://github.com/mjschock/datagrep" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">app</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-computeCost">computeCost</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-computeCostSync">computeCostSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-featureNormalize">featureNormalize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-featureNormalizeSync">featureNormalizeSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-gradientDescent">gradientDescent</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-gradientDescentSync">gradientDescentSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-normalEqn">normalEqn</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-normalEqnSync">normalEqnSync</a></span></span></li>
<li data-ice="doc"><div data-ice="dirPath" class="nav-dir-path">utils</div><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-asyncify">asyncify</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-errors">errors</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-errorsSync">errorsSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseCsv">parseCsv</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-parseCsvSync">parseCsvSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-readFile">readFile</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-readFileSync">readFileSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-add">add</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-addSync">addSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-angle">angle</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-angleSync">angleSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-crossproduct">crossproduct</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-crossproductSync">crossproductSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-divide">divide</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-divideSync">divideSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dot">dot</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-dotSync">dotSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isOrthogonal">isOrthogonal</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isOrthogonalSync">isOrthogonalSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isParallel">isParallel</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-isParallelSync">isParallelSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-magnitude">magnitude</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-magnitudeSync">magnitudeSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-max">max</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-maxSync">maxSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-mean">mean</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-meanSync">meanSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-multiply">multiply</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-multiplySync">multiplySync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-normalize">normalize</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-normalizeSync">normalizeSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-nullMatrix">nullMatrix</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-nullMatrixSync">nullMatrixSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-numCols">numCols</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-numColsSync">numColsSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-numRows">numRows</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-numRowsSync">numRowsSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-pinv">pinv</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-pinvSync">pinvSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-project">project</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-projectAndReject">projectAndReject</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-projectAndRejectSync">projectAndRejectSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-projectSync">projectSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-reject">reject</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-rejectSync">rejectSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-splitXy">splitXy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-splitXySync">splitXySync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-square">square</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-squareSync">squareSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-std">std</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-stdSync">stdSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-subtract">subtract</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-subtractSync">subtractSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-svd">svd</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-svdSync">svdSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-transpose">transpose</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-transposeSync">transposeSync</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-unit">unit</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-unitSync">unitSync</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/utils/linearAlgebra.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import { asyncify } from &apos;./common&apos;
import nj from &apos;numjs&apos;
import numeric from &apos;numericjs&apos;
import { Matrix, Vector } from &apos;vectorious&apos;
const parseFloat = Number.parseFloat

export {
  add,
  addSync,
  angle,
  angleSync,
  crossproduct,
  crossproductSync,
  divide,
  divideSync,
  dot,
  dotSync,
  isParallel,
  isParallelSync,
  isOrthogonal,
  isOrthogonalSync,
  magnitude,
  magnitudeSync,
  max,
  maxSync,
  mean,
  meanSync,
  multiply,
  multiplySync,
  normalize,
  normalizeSync,
  nullMatrix,
  nullMatrixSync,
  numCols,
  numColsSync,
  numRows,
  numRowsSync,
  pinv,
  pinvSync,
  project,
  projectSync,
  projectAndReject,
  projectAndRejectSync,
  reject,
  rejectSync,
  splitXy,
  splitXySync,
  square,
  squareSync,
  std,
  stdSync,
  subtract,
  subtractSync,
  svd,
  svdSync,
  transpose,
  transposeSync,
  unit,
  unitSync
}

function _arithmetic (operation, a, b) {
  operation = nj[operation]
  a = nj.array(a)
  b = nj.array(b)

  if (a.size !== b.size) {
    let results = b.tolist().map((currentValue, index) =&gt; {
      let col = a.slice(0, [index, index + 1]).tolist()
      let result = operation(col, currentValue).tolist()
      return result
    })
    return transposeSync(results)[0]
  }

  return operation(a, b).tolist()
}

function add (a, b, callback = () =&gt; {}) {
  return asyncify(addSync, callback)(...arguments)
}

function addSync (a, b) {
  return new Vector(a).add(new Vector(b)).toArray()
}

function angle (a, b, convertToDegrees = false, callback = () =&gt; {}) {
  return asyncify(angleSync, callback)(...arguments)
}

function angleSync (a, b, convertToDegrees = false) {
  const degreesPerRadian = 180 / Math.PI
  const radians = new Vector(a).angle(new Vector(b))

  if (convertToDegrees) return radians * degreesPerRadian
  return radians
}

function crossproduct (a, b, callback = () =&gt; {}) {
  return asyncify(crossproductSync, callback)(...arguments)
}

function crossproductSync (a, b) {
  const i = new Matrix([a.slice(1), b.slice(1)]).determinant()
  const j = -new Matrix([a.slice(0, 1).concat(a.slice(2)), b.slice(0, 1).concat(b.slice(2))]).determinant()
  const k = new Matrix([a.slice(0, 2), b.slice(0, 2)]).determinant()
  return [i, j, k]
}

function divide (a, b, callback = () =&gt; {}) {
  return asyncify(divideSync, callback)(...arguments)
}

function divideSync (a, b) {
  return _arithmetic(&apos;divide&apos;, a, b)
}

function dot (a, b, callback = () =&gt; {}) {
  return asyncify(dotSync, callback)(...arguments)
}

function dotSync (a, b) {
  return nj.dot(a, b).tolist()
}

function isParallel (a, b, precision = 21, callback = () =&gt; {}) {
  return asyncify(isParallelSync, callback)(...arguments)
}

function isParallelSync (a, b, precision = 21) {
  let radians = parseFloat(angleSync(a, b).toPrecision(precision))
  return isNaN(radians) || radians === 0 || radians === parseFloat(Math.PI.toPrecision(precision))
}

function isOrthogonal (a, b, precision = 21, callback = () =&gt; {}) {
  return asyncify(isOrthogonalSync, callback)(...arguments)
}

function isOrthogonalSync (a, b, precision = 21) {
  let radians = parseFloat(angleSync(a, b).toPrecision(precision))
  return isNaN(radians) || radians === parseFloat((Math.PI / 2).toPrecision(precision))
}

function magnitude (a, callback = () =&gt; {}) {
  return asyncify(magnitudeSync, callback)(...arguments)
}

function magnitudeSync (a) {
  return new Vector(a).magnitude()
}

function max (a, callback = () =&gt; {}) {
  return asyncify(maxSync, callback)(...arguments)
}

function maxSync (a) {
  // TODO: accomodate any dimension
  return nj.max(a)
}

function mean (a, callback = () =&gt; {}) {
  return asyncify(meanSync, callback)(...arguments)
}

function meanSync (a) {
  const _numRows = numRowsSync(a)
  const sums = a.reduce((accumulator, currentValue) =&gt; {
    currentValue.forEach((currentValue, index) =&gt; {
      accumulator[index] += currentValue
    })
    return accumulator
  }, new Array(numColsSync(a)).fill(0))
  const mean = sums.map((currentValue) =&gt; {
    return currentValue / _numRows
  })

  return mean
}

function multiply (a, b, callback = () =&gt; {}) {
  return asyncify(multiplySync, callback)(...arguments)
}

function multiplySync (a, b) {
  let result
  try {
    result = nj.multiply(a, b)
  } catch (error) {
    result = nj.multiply(b, a)
  }

  return result.tolist()
}

function normalize (a, callback = () =&gt; {}) {
  return asyncify(normalizeSync, callback)(...arguments)
}

function normalizeSync (a) {
  return new Vector(a).normalize().toArray()
}

function nullMatrix (numRows, numCols, callback = () =&gt; {}) {
  return asyncify(nullMatrixSync, callback)(...arguments)
}

function nullMatrixSync (numRows, numCols) {
  return nj.zeros([numRows, numCols]).tolist()
}

function numCols (a, callback = () =&gt; {}) {
  return asyncify(numColsSync, callback)(...arguments)
}

function numColsSync (a) {
  return nj.array(a).shape[1] || 1
}

function numRows (a, callback = () =&gt; {}) {
  return asyncify(numRowsSync, callback)(...arguments)
}

function numRowsSync (a) {
  return nj.array(a).shape[0]
}

function pinv (M, rcond = 1e-15, callback = () =&gt; {}) {
  return asyncify(pinvSync, callback)(...arguments)
}

function pinvSync (M, rcond = 1e-15) {
  let [U,, V, s] = svdSync(M)
  const &#x3B5; = numeric.epsilon
  const m = numRowsSync(U)
  const n = numColsSync(transposeSync(V))
  const diagDim = Math.max(m, n)
  const tolerance = &#x3B5; * diagDim * maxSync(s)
  const pinv&#x3A3; = transposeSync(numeric.diag(s.map((sNum, index) =&gt; {
    return index &lt; diagDim &amp;&amp; sNum &gt; tolerance ? 1 / sNum : 0
  })))
  const transposeU = transposeSync(U)
  const pinvM = dotSync(transposeSync(V), dotSync(pinv&#x3A3;, transposeU))

  return pinvM
}

function project (a, b, callback = () =&gt; {}) {
  return asyncify(projectSync, callback)(...arguments)
}

function projectSync (a, b) {
  return new Vector(a).project(new Vector(b)).toArray()
}

function projectAndReject (a, b, callback = () =&gt; {}) {
  return asyncify(projectAndRejectSync, callback)(...arguments)
}

function projectAndRejectSync (a, b) {
  return {
    projection: projectSync(a, b),
    rejection: rejectSync(a, b)
  }
}

function reject (a, b, callback = () =&gt; {}) {
  return asyncify(rejectSync, callback)(...arguments)
}

function rejectSync (a, b) {
  return subtractSync(a, projectSync(a, b))
}

function svd (a, callback = () =&gt; {}) {
  return asyncify(svdSync, callback)(...arguments)
}

// singular value decomposition
function svdSync (a) {
  const res = numeric.svd(a)
  const U = res.U
  const s = res.S // singular values, or s-numbers
  const &#x3A3; = numeric.diag(s)
  const transposeV = res.V
  const V = transposeSync(transposeV)

  return [U, &#x3A3;, V, s]
}

function splitXy (data, addOnes = true, callback = () =&gt; {}) {
  return asyncify(splitXySync, callback)(...arguments)
}

function splitXySync (data, addOnes = true) {
  const dataAsMatrix = nj.array(data)
  const [numRows, numCols] = dataAsMatrix.shape
  const y = dataAsMatrix.slice(0, -1).tolist()
  let X = dataAsMatrix.slice(0, [numCols - 1])
  if (addOnes) X = nj.concatenate(nj.ones([numRows, 1]), X)
  X = X.tolist()

  return { X, y }
}

function square (a, callback = () =&gt; {}) {
  return asyncify(squareSync, callback)(...arguments)
}

function squareSync (a) {
  a = nj.array(a)

  return a.T.dot(a).tolist()[0][0]
}

function std (a, callback = () =&gt; {}) {
  return asyncify(stdSync, callback)(...arguments)
}

function stdSync (a) {
  const t = nj.array(a).T
  const options = { &apos;ddof&apos;: 1 }
  const stdDevs = t.tolist().map((row) =&gt; {
    return nj.array(row).std(options)
  })

  return stdDevs
}

function subtract (a, b, callback = () =&gt; {}) {
  return asyncify(subtractSync, callback)(...arguments)
}

function subtractSync (a, b) {
  return _arithmetic(&apos;subtract&apos;, a, b)
}

function transpose (a, callback = () =&gt; {}) {
  return asyncify(transposeSync, callback)(...arguments)
}

function transposeSync (a) {
  return nj.array(a).T.tolist()
}

function unit (a, callback = () =&gt; {}) {
  return asyncify(unitSync, callback)(...arguments)
}

function unitSync (a) {
  return multiplySync(a, 1 / magnitude(a))
}
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.5.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
